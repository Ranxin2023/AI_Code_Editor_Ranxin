<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://js.puter.com/v2/"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/15.0.6/marked.min.js" integrity="sha512-rvRITpPeEKe4hV9M8XntuXX6nuohzqdR5O3W6nhjTLwkrx0ZgBQuaK4fv5DdOWzs2IaXsGt5h0+nyp9pEuoTXg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js" integrity="sha512-LQNxIMR5rXv7o+b1l8+N1EZMfhG7iFZ9HhnbJkTp4zjNr5Wvst75AqUeFDxeRUa7l5vEDyUiAip//r+EFLLCyA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.2.3/purify.min.js" integrity="sha512-Ll+TuDvrWDNNRnFFIM8dOiw7Go7dsHyxRp4RutiIFW/wm3DgDmCnRZow6AqbXnCbpWu93yM1O34q+4ggzGeXVA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        var require = {
            paths: {
                "vs": "./vendor/monaco-editor-0.44.0/min/vs"
            }
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/golden-layout/1.5.9/goldenlayout.min.js" integrity="sha256-NhJAZDfGgv4PiB+GVlSrPdh3uc75XXYSM4su8hgTchI=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/golden-layout/1.5.9/css/goldenlayout-base.css" integrity="sha512-rGtzJyDE8egZ/OScuBNLW1EIhRydcfrZo14oTvZwRLzEZu+s8foCtwi0XhXsKnhuoQAwJ7POFARWdU4fBL7FbQ==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link id="judge0-golden-layout-light-theme-stylesheet" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/golden-layout/1.5.9/css/goldenlayout-light-theme.css" integrity="sha512-/S3N+v8cRHW2GJvM3v9FGHAKOhNgws+V1dYZb1fBxRd9XIwpqZFZB0jug+2HHf64eURsJLqVzCVn92pQTFHHow==" crossorigin="anonymous" referrerpolicy="no-referrer" disabled>
    <link id="judge0-golden-layout-dark-theme-stylesheet" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/golden-layout/1.5.9/css/goldenlayout-dark-theme.css" integrity="sha512-XfcBrEH69BhsZ0XpvPyzOLgikhAvIG6Znbi6yKi1Jh1iYaOXSXvljWFerhcUl5LYLCuV61KhfCydQ1+MNxnilg==" crossorigin="anonymous" referrerpolicy="no-referrer">

    <script src="./vendor/monaco-editor-0.44.0/min/vs/loader.js"></script>
    <script src="./vendor/monaco-editor-0.44.0/min/vs/editor/editor.main.nls.js"></script>
    <script src="./vendor/monaco-editor-0.44.0/min/vs/editor/editor.main.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css" integrity="sha512-KXol4x3sVoO+8ZsWPFI/r5KBVB/ssCGB5tsv2nVOKwLg33wTFP3fmnXa47FdSVIshVTgsYk/1734xSk9aFIa4A==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.js" integrity="sha512-Xo0Jh8MsOn72LGV8kU5LsclG7SUzJsWGhXbWcYs2MAmChkQzwiW/yTQwdJ8w6UA9C6EVG18GHb/TrYpYCjyAQw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script type="module" src="js/ai.js"></script>
    <script type="module" src="js/electron.js"></script>
    <script type="module" src="js/ide.js"></script>
    <script type="module" src="js/local_storage.js"></script>
    <script type="module" src="js/puter.js"></script>
    <script type="module" src="js/query.js"></script>
    <script type="module" src="js/style.js"></script>
    <script type="module" src="js/theme.js"></script>

    <link type="text/css" rel="stylesheet" href="css/ide.css">
    <link type="text/css" rel="stylesheet" href="css/semantic.css">
    <link type="text/css" rel="stylesheet" href="css/site.css">

    <style>
        #chat-container {
            position: fixed;
            bottom: 10px;
            right: 10px;
            width: 300px;
            background: #f9f9f9;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
            z-index: 2000;
        }

        #chat-header {
            background: #007bff;
            color: #fff;
            padding: 10px;
            font-size: 16px;
            text-align: center;
            cursor: pointer;
        }

        #chat-body {
            display: none;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }

        #chat-input {
            border-top: 1px solid #ccc;
            display: flex;
        }

        #chat-input textarea {
            flex: 1;
            border: none;
            padding: 10px;
            font-size: 14px;
        }

        #chat-input button {
            background: #007bff;
            color: #fff;
            border: none;
            padding: 10px;
            cursor: pointer;
        }
        .inline-chat-box {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 2000;
        }

        .inline-chat-box textarea {
            width: 100%;
            margin-top: 5px;
            margin-bottom: 10px;
            resize: none;
        }

        .inline-chat-box button {
            background: #007bff;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>

    <title>Judge0 IDE</title>
    <meta name="title" content="Judge0 IDE">
    <meta name="description" content="Free and open-source online code editor and compiler">
    <meta name="author" content="Judge0 d.o.o.">
    <meta name="keywords" content="online editor, online code editor, online ide, online compiler, online interpreter, run code online, learn programming online,
    online debugger, programming in browser, online code runner, online code execution, debug online, debug C code online, debug C++ code online,
    programming online, snippet, snippets, code snippet, code snippets, pastebin, execute code, programming in browser, run c online, run C++ online,
    run java online, run python online, run ruby online, run c# online, run rust online, run pascal online, run basic online">

    <meta property="og:url" content="https://ide.judge0.com">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Judge0 IDE">
    <meta property="og:image" content="https://raw.githubusercontent.com/judge0/ide/refs/heads/master/.github/wallpaper.png">
    <meta property="og:image:alt" content="Judge0 IDE">
    <meta property="og:description" content="Free and open-source online code editor and compiler">
    <meta property="og:site_name" content="Judge0 IDE">
    <meta property="og:locale" content="en_US">

    <meta property="twitter:url" content="https://ide.judge0.com">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Judge0 IDE">
    <meta property="twitter:image" content="https://raw.githubusercontent.com/judge0/ide/refs/heads/master/.github/wallpaper.png">
    <meta property="twitter:description" content="Free and open-source online code editor and compiler">

    <link rel="shortcut icon" href="/favicons/favicon.ico">

    <link rel="icon" type="image/svg+xml" href="/favicons/favicon.svg">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicons/favicon-96x96.png">

    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/favicon-180x180.png">
    <meta name="apple-mobile-web-app-title" content="Judge0 IDE">

    <link rel="manifest" href="/manifest.json">

    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
</head>

<body>
    <div id="judge0-site-navigation" class="ui top fixed borderless menu">
        <a id="judge0-header" href="https://judge0.com" target="_blank" class="header item judge0-default-visible">
            <img id="judge0-logo" src="./images/icon_var2_rounded_512.png">
        </a>
        <div class="ui simple dropdown item">
            <span class="text">File</span>
            <i class="dropdown icon"></i>
            <div class="menu judge0-file-menu">
                <div id="judge0-open-file-btn" class="item">
                    <span class="description">+O</span>
                    <span class="text"><i class="file icon"></i>Open File...</span>
                    <input type="file" id="open-file-input" style="display: none;">
                </div>
                <div id="judge0-save-btn" class="item">
                    <span class="description">+S</span>
                    <span class="text"><i class="save icon"></i>Save</span>
                </div>
            </div>
        </div>
        <div class="ui simple dropdown item">
            <span class="text">Help</span>
            <i class="dropdown icon"></i>
            <div class="menu judge0-file-menu">
                <a href="https://github.com/judge0/ide" class="link text item" target="_blank"><i class="external square alternate icon"></i>GitHub Repository</a>
                <a href="https://github.com/judge0/ide/tree/master/embed" class="link text item" target="_blank"><i class="external square alternate icon"></i>Embed Guide</a>
                <a href="https://platform.sulu.sh/apis/judge0" class="link text item" target="_blank"><i class="external square alternate icon"></i>HTTP API Documentation</a>
                <a href="PRIVACY.md" class="link text item" target="_blank"><i class="external square alternate icon"></i>Privacy Policy</a>
                <a href="TERMS.md" class="link text item" target="_blank"><i class="external square alternate icon"></i>Terms of Service</a>
            </div>
        </div>
        <div class="item">
            <select id="select-language" class="ui search selection dropdown"></select>
        </div>
        <div class="item">
            <div class="ui left icon transparent input">
                <i class="flag icon"></i>
                <input id="compiler-options" type="text" placeholder="Compiler options"></input>
            </div>
        </div>
        <div class="item">
            <div class="ui left icon transparent input">
                <i class="terminal icon"></i>
                <input id="command-line-arguments" type="text" placeholder="Command line arguments"></input>
            </div>
        </div>
        <div class="item">
            <button id="run-btn" class="ui primary labeled icon button" data-content="+↵">
                <i class="play icon"></i>
                Run Code
            </button>
        </div>
        <div class="right menu">
            <div id="judge0-theme-toggle-btn" class="icon link item" data-content="">
                <i id="judge0-theme-toggle-btn-icon" class="sun icon"></i>
            </div>
            <div class="item judge0-minimal-hidden judge0-puter-hidden">
                <button id="judge0-sign-in-btn" class="ui basic button">
                    <i class="sign-in icon"></i>
                    Sign in with Puter
                </button>
                <button id="judge0-sign-out-btn" class="ui basic button" data-content="Sign out">
                    <i class="sign-out icon"></i>
                    <span id="judge0-puter-username">Sign out</span>
                </button>
            </div>
        </div>
    </div>

    <div id="judge0-site-content"></div>

    <div id="judge0-site-modal" class="ui modal">
        <div class="header">
            <span id="title"></span>
        </div>
        <div class="scrolling content"></div>
        <div class="actions">
            <a id="report-problem-btn" class="ui labeled icon red button" href="https://github.com/judge0/ide/issues/new?title=New+bug+report&body=Describe+the+problem." target="_blank">
                <i class="flag icon"></i>
                Report Problem
            </a>
            <div class="ui labeled icon cancel secondary button">
                <i class="close icon"></i>
                Close (ESC)
            </div>
        </div>
    </div>

    <div id="judge0-chat-container" class="ui segment">
        <div class="ui top attached borderless mini menu">
            <div class="right menu">
                <div class="fitted item">
                    <select id="judge0-chat-model-select" class="ui search selection dropdown item">
                        <option>gpt-4o-mini</option>
                        <option>gpt-4o</option>
                        <option>o3-mini</option>
                        <option>o1-mini</option>
                        <option>claude-3-5-sonnet</option>
                        <option>deepseek-chat</option>
                        <option>deepseek-reasoner</option>
                        <option>meta-llama/Meta-Llama-3.1-8B-Instruct-Turbo</option>
                        <option>meta-llama/Meta-Llama-3.1-70B-Instruct-Turbo</option>
                        <option>meta-llama/Meta-Llama-3.1-405B-Instruct-Turbo</option>
                        <option>mistral-large-latest</option>
                        <option>pixtral-large-latest</option>
                        <option>codestral-latest</option>
                        <option>google/gemma-2-27b-it</option>
                        <option>grok-beta</option>
                    </select>
                </div>
            </div>
        </div>
        <div id="judge0-chat-messages"></div>
        <div id="judge0-chat-input-container" class="ui basic segment">
            <form id="judge0-chat-form" class="ui fluid transparent input">
                <input id="judge0-chat-user-input" type="text" placeholder="Message AI">
            </form>
        </div>
    </div>

    <div id="judge0-status-line" class="ui bottom right attached small label"></div>

    <a href="https://judge0.com" target="_blank" class="ui bottom left attached small label judge0-default-visible">
        © 2016-2025 Judge0 d.o.o. – All Rights Reserved.
    </a>
<!-- style="
                    display: block;
                    position: absolute;
                    background: #fff;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    max-height: 150px;
                    overflow-y: auto;
                    z-index: 3000;
                " -->
    <div id="chat-container">
        <div id="chat-header">Chat Assistant</div>
        <div id="chat-body">
            <div id="chat-messages"></div>
                <div id="autocomplete-suggestions" ></div>
            <div id="chat-input">
                <textarea id="chat-textarea" placeholder="Type your question..."></textarea>
                <button id="chat-send">Send</button>
                <!-- Autocomplete Suggestion Box -->
            </div>
        </div>
    </div>

    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("sw.js").then(() => console.log("Service Worker Registered"));
        }

        // Toggle Chat Visibility
        $("#chat-header").on("click", function () {
            $("#chat-body").slideToggle();
        });
        // let editor;

        // // Initialize Monaco Editor
        // require(["vs/editor/editor.main"], function () {
        //     editor = monaco.editor.create(document.getElementById("judge0-site-content"), {
        //         value: "// Start coding here...\n",
        //         language: "javascript",
        //         theme: "vs-dark",
        //     });

        //     // Detect code selection
        //     editor.onDidChangeCursorSelection((e) => {
        //         const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        //         if (selectedText.trim()) {
        //             showInlineChatBox(selectedText, e.position);
        //         }
        //     });
        // });
         // Handle Chat Input for Autocomplete
        // Handle input in the chat textarea
        $("#chat-textarea").on("input", function () {
    const userInput = $(this).val().trim();
    console.log("User input:", userInput); // Log user input

    if (userInput) {
        $.ajax({
            url: "http://localhost:3000/autocomplete",
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify({ query: userInput }),
            success: function (data) {
                console.log("Suggestions received from backend:", data.suggestions); // Log suggestions
                const suggestions = data.suggestions;
                const suggestionBox = $("#autocomplete-suggestions");
                const textareaOffset = $("#chat-textarea").offset();
                
                const boxWidth = $("#chat-textarea").outerWidth();
                suggestionBox.css({
                    top: Math.min(textareaOffset.top + $("#chat-textarea").outerHeight(), $(window).height() - 150), // Prevent overflow
                    left: Math.min(textareaOffset.left, $(window).width() - boxWidth), // Prevent overflow
                    width: boxWidth,
                });
                suggestionBox.empty(); // Clear old suggestions
                /*
                style="
                                padding: 5px;
                                cursor: pointer;
                                border-bottom: 1px solid #f1f1f1;"
                                class="autocomplete-item"
                */
                if (suggestions && suggestions.length > 0) {
                    suggestions.forEach((suggestion) => {
                        suggestionBox.append(
                            `<div >
                                ${suggestion}
                            </div>`
                        );
                    });

                    // Show the suggestion box
                    suggestionBox.show();

                    // Position the suggestion box
                    const textareaOffset = $("#chat-textarea").offset();
                    suggestionBox.css({
                        top: textareaOffset.top + $("#chat-textarea").outerHeight(),
                        left: textareaOffset.left,
                        width: $("#chat-textarea").outerWidth(),
                    });
                    console.log("Suggestion box positioned:", suggestionBox.css("top"), suggestionBox.css("left"));
                    console.log("Window width:", $(window).width());
                    console.log("Window height:", $(window).height());

                } else {
                    console.log("No suggestions available");
                    suggestionBox.hide();
                }
            },
            error: function () {
                console.error("Failed to fetch autocomplete suggestions.");
                $("#autocomplete-suggestions").hide();
            },
        });
    } else {
        console.log("User input cleared");
        $("#autocomplete-suggestions").hide();
    }
});

        // Handle Chat Input
        $("#chat-send").on("click", function () {
            const message = $("#chat-textarea").val();
            if (message.trim()) {
                $("#chat-messages").append(`<div><strong>You:</strong> ${message}</div>`);
                $("#chat-textarea").val("");

                // Send message to the server
                $.ajax({
                    url: "http://localhost:3000/chat",
                    method: "POST",
                    contentType: "application/json",
                    data: JSON.stringify({ message }),
                    success: function (data) {
                        $("#chat-messages").append(
                            `<div><strong>AI:</strong> ${data.reply}</div>`
                        );
                    },
                    error: function () {
                        $("#chat-messages").append(
                            `<div><strong>AI:</strong> Sorry, something went wrong.</div>`
                        );
                    },
                });
            }
        });
        $(document).on("click", ".autocomplete-item", function () {
            const selectedText = $(this).text();
            $("#chat-textarea").val(selectedText);
            $("#autocomplete-suggestions").hide();
        });
        // // Handle Chat Input
        // $("#chat-send").on("click", function () {
        //     const message = $("#chat-textarea").val();
        //     const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        //     console.log("Selected text is", selectedText)
        //     if (message.trim() && selectedText.trim()) {
        //         $("#chat-messages").append(`<div><strong>You:</strong> ${message}</div>`);
        //         $("#chat-textarea").val("");

        //         // Call sendChatRequest with the selected code and question
        //         sendChatRequest(selectedText, message, null); // Pass null for the inline chatBox since this is the global chat
        //     } else {
        //         alert("Please select some code and enter a question before sending.");
        //     }
        // });

        // // Send chat request to the backend
        // function sendChatRequest(selectedText, question, chatBox) {
        //     $.ajax({
        //         url: "http://localhost:3000/chat",
        //         method: "POST",
        //         contentType: "application/json",
        //         data: JSON.stringify({
        //             message: `Code: ${selectedText}\nQuestion: ${question}`,
        //         }),
        //         success: function (data) {
        //             if (chatBox) {
        //                 // If called from an inline chat box
        //                 chatBox.querySelector(".response").innerText = data.reply;
        //             } else {
        //                 // If called from the main chat box
        //                 $("#chat-messages").append(
        //                     `<div><strong>AI:</strong> ${data.reply}</div>`
        //                 );
        //             }
        //         },
        //         error: function () {
        //             if (chatBox) {
        //                 chatBox.querySelector(".response").innerText = "Failed to fetch response.";
        //             } else {
        //                 $("#chat-messages").append(
        //                     `<div><strong>AI:</strong> Sorry, something went wrong.</div>`
        //                 );
        //             }
        //         },
        //     });
        // }
        // function showInlineChatBox(selectedText, position) {
        //     // Create a chat box dynamically
        //     const chatBox = document.createElement("div");
        //     chatBox.className = "inline-chat-box";
        //     chatBox.style.position = "absolute";
        //     chatBox.style.left = `${position.column * 8}px`;
        //     chatBox.style.top = `${position.lineNumber * 18}px`;
        //     chatBox.style.zIndex = 1000;
        //     chatBox.style.backgroundColor = "#f9f9f9";
        //     chatBox.style.padding = "10px";
        //     chatBox.style.borderRadius = "8px";
        //     chatBox.style.boxShadow = "0px 4px 6px rgba(0,0,0,0.1)";
        //     chatBox.innerHTML = `
        //         <strong>Chat Assistant:</strong>
        //         <p><em>${selectedText}</em></p>
        //         <textarea placeholder="Ask a question..." rows="3" style="width: 100%; margin-top: 5px;"></textarea>
        //         <button style="margin-top: 5px; background-color: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 4px;">Send</button>
        //         <div class="response" style="margin-top: 10px;"></div>
        //     `;

        //     document.body.appendChild(chatBox);

        //     // Handle Send button click
        //     const button = chatBox.querySelector("button");
        //     button.addEventListener("click", () => {
        //         const question = chatBox.querySelector("textarea").value;
        //         if (question.trim()) {
        //             chatBox.querySelector(".response").innerText = "Processing...";
        //             sendChatRequest(selectedText, question, chatBox);
        //         }
        //     });
        // }

    </script>
</body>

</html>
